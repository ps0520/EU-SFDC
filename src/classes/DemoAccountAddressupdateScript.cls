public class DemoAccountAddressupdateScript {
    
    //DemoAccountAddressupdateScript.updateAccountAddress();
   
    
    public static void updateAccountAddress(){
        //'1581212',463534,468794
        
        set<string> Definedlist = new set<string>();
        String strAccountnum = '1298231,1233844,1810330,1713450,881186,483975,1696888,858976,1581212,1858709,825800,463534,1602846,468794,1419440,1682848,1283356,485351,1653196,486887,1839544,1694285,1027565,1633435,1640694,894412,1695416,538254,536025,1670315,1823205,1412274,1639969,529758,1669232,1163101,1657270,649835,1365234,1667696,1687112,1811575,544200,1625764,1678817,1282265,546098,1653201,1039066,1683385,1657843,999351,1673640,1854257,882461,619322,1626962,1684925,1326214,1568193,1696418,979391,1672986,784154,1356547,1860334,791267,821377,830961,1695375,1680006,1695343,1255360,1036247,831036,895421,1226407,1684558,1671321,831223,1676937,1138096,831421,1674337,1249499,1664096,1877497,841044,1777428,842279,1695382,870873,1729089,1038672,1653703,891752,1685815,1573013,1664669,872872,1548778,1751034,1241761,1686140,1238309,1708984,1631178,1843692,888421,1799693,1670188,1316494,1759247,901049,1695328,909723,913322,1648146,922345,1017572,1695388,1848059,1672611,1735698,1099164,1671939,1120030,1629474,1630982,1134727,1698380,1162958,1559583,1696945,1221646,1602659,1335521,1608420,1252740,1628898,1272766,1278142,1683597,1761332,1304559,1305846,1846832,1572515,1864216,1345367,1351218,1694147,1357981,1691403,1746068,1624450,1842085,1210108,1746149,1698448,1696403,1359631,1367799,1368191,1638306,1368592,1407218,1695265,1697966,1626845,1728954,1407237,1407259,1671282,1407654,1817993,1412042,1680625,1413463,1694624,1416089,1696704,1417115,1635617,1660517,1696861,1417634,1780954,1420557,1679738,1423526,1674591,1863932,1698487,1424451,1653680,1426077,1592300,1427091,1866306,1678469,1687889,1885628,1754871,1697734,1427745,1676392,1435703,1683862,1685934,1440113,1697889,1645313,1695415,1697978,1440115,1697761,1443831,1738674,1675969,1783601,1451634,1667240,1837708,1452560,1685055,1491045,1673035,1510856,1692018,1727461,1544352,1697733,1549952,1695545,1632497,1564047,1565752,1566439,1638648,1567235,1883217,1567300,1714177,1570983,1571142,1692241,1762974,1687533,1574853,1636012,1575138,1580850,1584974,1231868,1730214,1703921,1668071,1586863,1622771,1587597,1715794,1589451,1590453,1590969,1724336,1591599,1595150,1656630,1595320,1687592,1596378,1692957,1599560,1630345,1599564,1684503,1795790,1599578,1600335,1693496,1601255,1668087,1623379,1601322,1602844,1603029,1603200,1604456,1437822,1605064,1626190,1658265,1605066,1675043,1724293,1605105,1605107,1845600,1606950,1684926,1607175,1608476,1609282,1674403,1618815,1619060,1620396,1620867,1692081,1659233,1621031,1695395,1621206,1697936,1622740,1623040,1623188,1623203,1676936,1823445,1625350,1626450,1659234,1626592,1626977,1667045,1682500,Unknown,1661678,1791860,1668984,1627131,1766145,1632361,1627287,1627867,1695417,1843631,1628128,1678818,1629470,1629551,1652549,1630615,1644829,1755566,1652128,1782392,1631261,1697553,1631821,1647605,1675910,1639225,1710570,1637079,1696144,1633577,1633745,1663876,1685771,1633991,1697690,1635102,1638225,1757754,1664357,1687877,1635162,1635863,1636103,1664038,1716204,1663335,1637027,1637231,1232635,1637377,1681111,1659933,1639134,1869832,1639291,1639303,1687965,1640343,1640368,1653806,1683646,1774003,1643649,1893109,1757214,1643674,1712728,1644799,1644830,1660057,1663360,1671911,1644991,1657868,1868772,1645210,1646119,1683094,1647003,1697074,1647381,1648604,1648622,1721166,1649150,1649191,1671322,1650346,1696237,1650459,1690069,1897761,1875621,1650494,1652683,1697419,1653749,1653998,1654346,1654375,1695544,1667692,1706878,1654534,1730951,1654646,1654941,1654947,1655122,1663308,1655143,1311709,1655242,1664298,1655355,1656778,1657643,1657867,1658357,1658934,1711929,1659337,1687570,1660229,1899984,1660434,1677089,1661566,1243041,1746118,1662232,1671323,1662737,1663046,1689772,1869837,1681904,1697651,1664048,1666447,1664276,1664281,1665502,1665569,1665748,1665770,1665793,1748970,1665908,1049373,1666055,1669371,1696411,1666076,1864213,1666681,799301,1701778,1666698,1666938,1667033,1693754,1694184,1667129,1674051,1667420,1690616,1683475,1696611,1667673,1688866,1667678,1773626,1667728,1668070,1668157,1689952,1695859,1668237,1689023,1669570,1688826,1860011,1675163,1669936,1679441,1670032,1670340,1726974,1670912,1671052,1406436,1671277,1839434,1671328,1678778,1671341,1761915,1671768,1672194,1685234,1697865,1672225,1783400,1764963,1672436,1676856,1698511,1672951,1673376,1689270,1673611,1673712,1673808,1674109,1864235,1674214,1687096,1774470,1701083,1674229,1861354,1674390,1682375,1674463,1675388,1856213,1675466,1676186,1676258,1782966,1676974,1864233,1676997,1678339,1678953,1695634,1679908,1679639,1762418,1679640,1682400,1679735,1721643,1679909,1875819,1679947,1683863,1698141,1680650,1710819,1680690,1680965,1681267,1681285,1681286,1825481,1701281,1682852,1689535,1693097,1698408,1681411,1682225,1682235,1682297,1682415,1694904,1695439,1603906,1682567,1682603,1684044,1683163,1683811,1684150,1684474,1695362,1749316,1724278,1685158,1685557,1686181,1686190,1847947,1686609,1686745,1686868,1765951,1692963,1687185,1687429,1687535,1687607,1725472,1687639,1688018,1695771,1688343,1817606,1689178,1689498,1689532,1690690,1691794,1698142,1691950,1692105,1692163,1695590,1697533,1692569,1692679,1693161,1693179,1693183,1885458,1693469,1694146,1694899,1694926,1694956,1755775,1695187,1700921,1695329,1695334,1695371,1695383,1695619,1721116,1695649,1695791,1695863,1695864,1895604,1695896,1695996,1696034,1696130,1703969,1696145,1696236,1696279,1696280,1696281,1696410,1801561,1696414,1728417,1712498,1697550,1696419,1696559,1899618,1696616,1696768,1784572,1696828,1868725,1696975,1697122,1721132,1697141,1697167,1697232,1697420,1800477,1697448,1697542,1697543,1697544,1745975,1697572,1697791,1734755,1697827,1697847,1697887,1734735,1697920,1697990,1713068,1697992,1697993,1698109,1895223,1848389,1698208,1698319,1698395,1698424,1698462,1765087,1698505,1724306,1625320,1724337,1704148,1704968,1707137,1837976,1707543,1708231,1712318,1814377,1715596,1716743,1716744,1721348,1823667,1724524,1864231,1726435,1811731,1730265,1730924,1732870,1733464,1733848,1733858,1734738,855013,1734837,1735313,1751518,1736224,1895412,1861920,1736385,1738356,1738400,1738611,1897319,1739748,1740651,1743477,1645951,1744796,1842773,1746167,1748585,1749155,1823050,1776222,1751962,1753874,1453957,1757452,1759281,1760181,1761219,1761440,1762336,1762816,1763604,1803424,1763945,1766684,Unknown,1768237,1768651,1771685,1772542,1772760,1774801,1776110,1777485,1864228,1307967,1780848,1782205,1848246,1782241,1858911,1782309,1594493,1784948,1785944,1412269,1792411,1803747,1842251,1804119,1808359,1811744,1814403,1815699,1830010,1098124,1830114,1834596,1834995,1839379,1853214,1855756,1855986,1857739,1859722,1859917,1861111,1862646,1865876,1862829,1345211,1372541,1899284,1863959,1864227,1864229,1864230,1865797,1867570,1867606,1867641,1868526,1870988,1874259,1874663,1876773,1877734,1878357,1882298,1883028,1883918,1220453,1886248,1888959,1892641,1893342,1893377,1897514,1659335,1898428,1899632';
        String[] splitAccounts = strAccountnum.split(',');
        for(String acNum :splitAccounts){
            Definedlist.add(acNum);
        }
        System.debug('Definedlist---'+Definedlist.size());
        //Definedlist.add('1419440');
        Integer shiptoCounter = 0;
        Integer billtoCounter = 0;
        Set<Id> successAcUpdateIds = new Set<Id>();
        List<Account> lstaccToupdate = new List<Account>();
        Set<Id> sertupdate = new Set<Id>();
        Map<string,Integer> mapAddressNOTFound = new Map<string,Integer>();
        Map<String,Account> mapAccupdate = new Map<String,Account>();
        Map<string,List<Address__c>> mapAddress = new Map<string,List<Address__c>>();
        List<Account> lstAccounts = [SELECT Id,AccountNumber, (SELECT Id, Account__c, Address_Line_1__c, 
                                    Address_Line_2__c, Address_Line_3__c,
                                    City__c, Country__c,State__c,Postal_code__c, Type__c, Primary_Flag__c 
                                    FROM Addresses__r where Primary_Flag__c =true)
                                     FROM Account
                                     where AccountNumber IN: Definedlist offset 10];
        System.debug('AccountSize--'+lstAccounts.size());
        
        if(lstAccounts.size()>0){
            for(Account accupdate : lstAccounts){
                
                shiptoCounter = 0;
                billtoCounter = 0;
                If(accupdate.Addresses__r.size() == 0){
                    //System.debug('No address found for Account '+accupdate.Id);
                    mapAddressNOTFound.put(accupdate.id,0);
                }
                for(Address__c adrt : accupdate.Addresses__r){
                    if(adrt.type__c == 'Ship To'){                        
                        shiptoCounter++;
                        if(shiptoCounter <=1){
                            accupdate.ShippingCountry =  adrt.Country__c;
                            accupdate.ShippingStreet = adrt.Address_Line_1__c;                       
                            accupdate.ShippingCity = adrt.City__c;
                            accupdate.ShippingState = adrt.State__c;
                            accupdate.ShippingPostalCode  = adrt.Postal_code__c;
                        }else{
                            System.debug('**Warning--Multiple Primary Ship to addresses found of Account-- '+accupdate.Id);
                        }
                    }else if(adrt.type__c == 'Bill To'){
                        billtoCounter++;
                        if(billtoCounter <= 1 ){
                            accupdate.BillingCountry =  adrt.Country__c;
                            accupdate.BillingStreet = adrt.Address_Line_1__c;                       
                            accupdate.BillingCity = adrt.City__c;
                            accupdate.BillingState = adrt.State__c;
                            accupdate.BillingPostalCode  = adrt.Postal_code__c; 
                        }else{
                            System.debug('**Warning--Multiple Primary Bill to addresses found of Account-- '+accupdate.Id);
                        }
                    }
                    if(mapAccupdate.containskey(accupdate.Id)){
                        account acct = mapAccupdate.get(accupdate.Id);
                        mapAccupdate.put(accupdate.Id,acct);
                        
                    }else{
                        mapAccupdate.put(accupdate.Id,accupdate);
                    }
                   lstaccToupdate.add(accupdate);
                sertupdate.add(accupdate.Id);
                }
                
            }    
        }
        System.debug('Account That dont have address are-->'+mapAddressNOTFound.size());
        System.debug('Account have addess-->'+lstaccToupdate.size());
        System.debug('Account have addess sertupdate-->'+sertupdate.size());
       
       Database.saveResult[] rslt=Database.update(lstaccToupdate, false);
        for(Database.saveResult r: rslt){
            if(r.isSuccess()){
                //System.debug('SuccessIds--'+r.getId());
                successAcUpdateIds.add(r.getId());
            }
            else{
                  for(Database.Error err : r.getErrors()){
                    System.debug('The following error has occurred.');                    
                    System.debug('--Status_Code--'+err.getStatusCode() + ': ' + err.getMessage());
                    System.debug('--Account fields that affected this error: ' + err.getFields());
                }
            }
        }
       //update lstAccounts;
       System.debug('--Account Address update Completed--'+successAcUpdateIds.size());
    }
}